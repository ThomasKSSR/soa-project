@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

Person(user, "End User")

Container(nginx, "NGINX", "Reverse Proxy / Load Balancer")

Container(api1, "API Gateway 1", "Spring Cloud Gateway", "JWT auth, routing")
Container(api2, "API Gateway 2", "Spring Cloud Gateway", "JWT auth, routing")

Container(user1, "User Service 1", "Spring Boot", "User management")
Container(user2, "User Service 2", "Spring Boot", "User management")

Container(notification, "Notification Service", "Spring Boot", "Sends notifications")

Container_Ext(kafka, "Kafka", "Event Streaming")
Container_Ext(rabbitmq, "RabbitMQ", "Message Broker")

Rel(user, nginx, "HTTPS")
Rel(nginx, api1, "Forwards requests")
Rel(nginx, api2, "Forwards requests")

Rel(api1, user1, "REST")
Rel(api1, user2, "REST")
Rel(api2, user1, "REST")
Rel(api2, user2, "REST")

Rel(user1, kafka, "Publishes events")
Rel(notification, kafka, "Consumes events")

Rel(user1, rabbitmq, "Sends messages")
Rel(notification, rabbitmq, "Consumes messages")

@enduml
